{"version":3,"sources":["../src/attendance.js"],"names":["define","$","Ajax","Log","AttendanceControl","username","campus","self","prototype","main","setupEvents","on","getAttendanceRollmarking","click","trigger","removeAttr","toggle","call","methodname","args","done","response","htmlResult","html","attr","replaceWith","fail","reason","error","debug","init","element","document","getElementById","getAttribute","control"],"mappings":"AAsBAA,OAAM,+BAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,UAAxB,CAAD,CAAsC,SAAUC,CAAV,CAAaC,CAAb,CAAmBC,CAAnB,CAAwB,CAChE,aAgBA,QAASC,CAAAA,CAAT,CAA2BC,CAA3B,CAAqCC,CAArC,CAA6C,CACzC,GAAIC,CAAAA,CAAI,CAAG,IAAX,CACAA,CAAI,CAACF,QAAL,CAAgBA,CAAhB,CACAE,CAAI,CAACD,MAAL,CAAcA,CACjB,CAMDF,CAAiB,CAACI,SAAlB,CAA4BC,IAA5B,CAAmC,UAAY,CAC3C,GAAIF,CAAAA,CAAI,CAAG,IAAX,CACAA,CAAI,CAACG,WAAL,EAGH,CALD,CAOAN,CAAiB,CAACI,SAAlB,CAA4BE,WAA5B,CAA0C,UAAY,CAClD,GAAIH,CAAAA,CAAI,CAAG,IAAX,CAEAN,CAAC,CAAC,yBAAD,CAAD,CAA6BU,EAA7B,CAAgC,iCAAhC,CAAmE,UAAY,CAC3EJ,CAAI,CAACK,wBAAL,EACH,CAFD,EAIAX,CAAC,CAAC,yBAAD,CAAD,CAA6BY,KAA7B,CAAmC,UAAY,CAC3CZ,CAAC,CAAC,IAAD,CAAD,CAAQa,OAAR,CAAgB,iCAAhB,CACH,CAFD,CAGH,CAVD,CAYAV,CAAiB,CAACI,SAAlB,CAA4BI,wBAA5B,CAAuD,UAAY,IAC3DL,CAAAA,CAAI,CAAG,IADoD,CAEzDF,CAAQ,CAAGE,CAAI,CAACF,QAFyC,CAGzDC,CAAM,CAAGC,CAAI,CAACD,MAH2C,CAM/DL,CAAC,CAAC,wCAAD,CAAD,CAA4Cc,UAA5C,CAAuD,QAAvD,EACAd,CAAC,CAAC,uCAAD,CAAD,CAA2Ce,MAA3C,GACAf,CAAC,CAAC,uCAAD,CAAD,CAA2Ce,MAA3C,GAEAd,CAAI,CAACe,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,qDADL,CAEPC,IAAI,CAAE,CACFd,QAAQ,CAAEA,CADR,CAEFC,MAAM,CAAEA,CAFN,CAFC,CAOPc,IAAI,CAAE,cAAUC,CAAV,CAAoB,CACtB,GAAMC,CAAAA,CAAU,CAAGD,CAAQ,CAACE,IAA5B,CAGAtB,CAAC,CAAC,wCAAD,CAAD,CAA4CuB,IAA5C,CAAiD,QAAjD,KACAvB,CAAC,CAAC,0CAAD,CAAD,CAA4CwB,WAA5C,CAAwDH,CAAxD,CACH,CAbM,CAePI,IAAI,CAAE,cAAUC,CAAV,CAAkB,CACpBxB,CAAG,CAACyB,KAAJ,CAAU,oFAAV,EACAzB,CAAG,CAAC0B,KAAJ,CAAUF,CAAV,EACA1B,CAAC,CAAC,sCAAD,CAAD,CAAwCwB,WAAxC,CAAoD,0EAApD,CACH,CAnBM,CAAD,CAAV,CAsBH,CAhCD,CAmCA,MAAO,CACHK,IAAI,CA/ER,UAAgB,CACZ3B,CAAG,CAAC0B,KAAJ,CAAU,sDAAV,EADY,GAENE,CAAAA,CAAO,CAAGC,QAAQ,CAACC,cAAT,CAAwB,uBAAxB,CAFJ,CAGN5B,CAAQ,CAAG0B,CAAO,CAACG,YAAR,CAAqB,eAArB,CAHL,CAIN5B,CAAM,CAAGyB,CAAO,CAACG,YAAR,CAAqB,aAArB,CAJH,CAKRC,CAAO,CAAG,GAAI/B,CAAAA,CAAJ,CAAsBC,CAAtB,CAAgCC,CAAhC,CALF,CAMZ6B,CAAO,CAAC1B,IAAR,EACH,CAuEM,CAGV,CApFK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n\n/**\n * @package   report_mystudent\n * @copyright 2022 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/log'], function ($, Ajax, Log) {\n    'use strict';\n\n    function init() {\n        Log.debug(\"mystudent: attendance report : initialising controls\");\n        const element = document.getElementById('rollmarking-container');\n        const username = element.getAttribute('data-username');\n        const campus = element.getAttribute('data-campus');\n        var control = new AttendanceControl(username, campus);\n        control.main();\n    }\n\n    /**\n     * AttendanceControl a single block_assignmentsquizzes_report block instance contents.\n     *\n     * @constructor\n     */\n    function AttendanceControl(username, campus) {\n        let self = this;\n        self.username = username;\n        self.campus = campus;\n    }\n\n    /**\n     * Run the controller.\n     *\n     */\n    AttendanceControl.prototype.main = function () {\n        let self = this;\n        self.setupEvents();\n        //self.getAttendanceRollmarking();\n\n    };\n\n    AttendanceControl.prototype.setupEvents = function () {\n        let self = this;\n\n        $('.attendance-rollmarking').on('custom.getAttendanceRollmarking', function () {\n            self.getAttendanceRollmarking();\n        });\n\n        $('.attendance-rollmarking').click(function () {\n            $(this).trigger(\"custom.getAttendanceRollmarking\");\n        });\n    };\n\n    AttendanceControl.prototype.getAttendanceRollmarking = function () {\n        let self = this;\n        const username = self.username;\n        const campus = self.campus;\n\n        // Add spinner.\n        $('#attendance-based-on-rollmarking-table').removeAttr('hidden');\n        $('#attendance-based-on-rollmarking-show').toggle(); // Carret down.\n        $('#attendance-based-on-rollmarking-hide').toggle(); // Carret right\n\n        Ajax.call([{\n            methodname: 'report_mystudent_get_attendance_rollmarking_context',\n            args: {\n                username: username,\n                campus: campus\n            },\n\n            done: function (response) {\n                const htmlResult = response.html;\n                // $('[data-region=\"rm-table-container\"]').delay(2000).fadeOut(400);\n                // $('[data-region=\"rm-table-container\"]').replaceWith(htmlResult);\n                $('#attendance-based-on-rollmarking-table').attr('hidden', true);\n                $('[data-region=\"attendance-rollmarking\"]').replaceWith(htmlResult);\n            },\n\n            fail: function (reason) {\n                Log.error('block_attendance_report_get_attendance_rollmarking_context: Unable to get context.');\n                Log.debug(reason);\n                $('[data-region=\"rm-table-container\"]').replaceWith('<p class=\"alert alert-danger\">Data not available. Please try later</p>');\n            }\n        }]);\n\n    };\n\n\n    return {\n        init: init\n    }\n});"],"file":"attendance.min.js"}