define ("report_mystudent/academicinfo_old",["jquery","core/ajax","core/log","report_mystudent/chart"],function(a,b,c,d){'use strict';function e(){}e.prototype.main=function(){var a=this,b=document.querySelector("[data-username]").getAttribute("data-campus");if("Senior"==b){a.trendChartSenior();a.getGradeHistory();a.getEffortHistory()}else{a.trendChartPrimary()}};e.prototype.trendChartSenior=function(){var a=document.getElementById("trendChart");if(!a){return}for(var b=document.querySelector("#performance"),c=JSON.parse(b.dataset.performance),e=[],f=[],g=[],h=[],j=[],k=[],l={avgattendance:"Average Attendance",avgeffort:"Average Effort",avggrades:"Average Grade"},m=0;m<c.length;m++){var n=c[m],o=n.details.year.toString(),p=n.details.term.toString();e.push(["T"+p,o]);k.push(n.details.avggrades);j.push(n.details.avggrades);h.push(n.details.avgeffort);g.push(n.details.avgattendance)}f.push({label:l.avggrades,data:j,fill:!1,borderColor:"#31326f",backgroundColor:"#31326f",tension:.1});f.push({label:l.avgeffort,data:h,fill:!1,borderColor:"#ffc93c",backgroundColor:"#ffc93c",tension:.1});f.push({label:l.avgattendance,data:g,fill:!1,borderColor:"#1687a7",backgroundColor:"#1687a7",tension:.1});new d(a,{type:"line",data:{labels:e,datasets:f},options:{responsive:!0,maintainAspectRatio:!1},plugins:[{id:"custom_canvas_background_color",beforeDraw:function beforeDraw(a){var b=a.canvas.getContext("2d");b.save();b.globalCompositeOperation="destination-over";b.fillStyle="#f6f5f5";b.fillRect(0,0,a.width,a.height);b.restore()}}]})};e.prototype.trendChartPrimary=function(){var a=document.getElementById("trendChart");if(!a){return}for(var b=document.querySelector("#performance"),c=JSON.parse(b.dataset.performance),e=[],f=[],g=[],h=[],j=[],k={avgattendance:"Average Attendance",avgeffort:"Average Effort",avggrades:"Average Grade"},l={e:"Excellent (E)",vg:"Very Good (VG)",avg:"Average (AVG)",ni:"Needs Improvement (NI)"},m={be:"Below Expectations",gs:"Good start (GS)",ms:"Making strides (MS)",grwi:"Go run with it (GRWI)",ae:"Above expectations"},n=function(a){for(var b=[],c=[],d=[],e=0;e<a.length;e++){if(a[e]==void 0){c.push(e)}else{b.push(e)}}for(var f=0,g=c,h;f<g.length;f++){h=g[f];if(0<h&&h<a.length-1){var j=[q(a,h),o(a,h)];d.push(j)}}d=d.filter(function(a){return a!==void 0})},o=function(a,b){var c=!0,d=++b;while(c&&d<a.length){if(a[d]!=void 0){c=!1}else{d++}}return a[d]},q=function(a,b){var c=!0,d=--b;while(c&&0<d){if(a[d]!=void 0){c=!1}else{d--}}return a[d]},r=0;r<c.length;r++){var s=c[r],p=s.details.year.toString(),t=s.details.term.toString();e.push(["T"+t,p]);if(null==s.details.avggrades){s.details.avggrades=void 0}j.push(s.details.avggrades);if(null==s.details.effortaverage){s.details.effortaverage=void 0}h.push(s.details.effortaverage);if(null==s.details.percentageattended){s.details.percentageattended=void 0}g.push(s.details.percentageattended)}var u=function(a,b){return a.p0.skip||a.p1.skip?b:void 0},v=n(j),w=n(h),x=n(g);f.push({label:k.avggrades,data:j,fill:!1,borderColor:"#31326f",segment:{borderDash:function borderDash(a){return u(a,v)}},backgroundColor:"#31326f",tension:.1});f.push({label:k.avgeffort,data:h,fill:!1,borderColor:"#ffc93c",segment:{borderDash:function borderDash(a){return u(a,w)}},backgroundColor:"#ffc93c",tension:.1});f.push({label:k.avgattendance,data:g,fill:!1,borderColor:"#1687a7",segment:{borderDash:function borderDash(a){return u(a,x)}},backgroundColor:"#1687a7",tension:.1});new d(a,{type:"line",data:{labels:e,datasets:f},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function label(a){if(a.dataset.label==k.avggrades){if(0<a.parsed.y&&20>=a.parsed.y){return m.be}else if(20<a.parsed.y&&40>=a.parsed.y){return m.gs}else if(40<a.parsed.y&&60>=a.parsed.y){return m.ms}else if(60<a.parsed.y&&80>=a.parsed.y){return m.grwi}else if(80<a.parsed.y){return m.ae}}if(a.dataset.label==k.avgeffort){if(0<parseFloat(a.parsed.y)&&25>=parseFloat(a.parsed.y)){return l.ni}else if(25<parseFloat(a.parsed.y)&&50>=parseFloat(a.parsed.y)){return l.avg}else if(50<parseFloat(a.parsed.y)&&95>parseFloat(a.parsed.y)){return l.vg}else if(95<=parseFloat(a.parsed.y)){return l.e}}else{return a.parsed.y+"%"}}}}},scales:{y:{suggestedMin:25,display:!1}}},plugins:[{id:"custom_canvas_background_color",beforeDraw:function beforeDraw(a){var b=a.canvas.getContext("2d");b.save();b.globalCompositeOperation="destination-over";b.fillStyle="#f6f5f5";b.fillRect(0,0,a.width,a.height);b.restore()}}]})};e.prototype.getEffortHistory=function(){var d=document.querySelector(".grade-effort-trend"),e=d.getAttribute("data-username"),f=d.getAttribute("data-campus");a("#effort-history-tb").removeAttr("hidden");b.call([{methodname:"report_mystudent_get_effort_history",args:{username:e,campus:f},done:function done(b){c.debug(b);var d=b.html;a("#effort-history-tb").attr("hidden",!0);a("[data-region=\"effort-history-table\"]").replaceWith(d)},fail:function fail(b){c.error("report_mystudent: Unable to get context.");c.debug(b);a("[data-region=\"effort-history-table\"]").replaceWith("<p class=\"alert alert-danger\">Data not available. Please try later</p>")}}])};e.prototype.getGradeHistory=function(){var d=document.querySelector(".grade-effort-trend"),e=d.getAttribute("data-username"),f=d.getAttribute("data-campus");a("#grade-history-tb").removeAttr("hidden");b.call([{methodname:"report_mystudent_get_grade_history",args:{username:e,campus:f},done:function done(b){c.debug(b);var d=b.html;a("#grade-history-tb").attr("hidden",!0);a("[data-region=\"grade-history-table\"]").replaceWith(d)},fail:function fail(b){c.error("report_mystudent: Unable to get context.");c.debug(b);a("[data-region=\"grade-history-table\"]").replaceWith("<p class=\"alert alert-danger\">Data not available. Please try later</p>")}}])};return{init:function(){var a=new e;a.main()}}});
//# sourceMappingURL=academicinfo_old.min.js.map
