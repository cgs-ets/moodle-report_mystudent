function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}f(void 0)})}}define ("report_mystudent/academicinfo",["jquery","core/log","report_mystudent/chart","core/ajax"],function(a,b,c,d){'use strict';function e(){var c=document.querySelector("[data-username]").getAttribute("data-username"),e=document.querySelector("[data-campus]").getAttribute("data-campus");document.getElementById("overlay").style.display="flex";document.querySelector(".card-img-academic").firstElementChild.style.display="flex";d.call([{methodname:"report_mystudent_get_grade_effort_trend",args:{username:c,campus:e},done:function done(a){var c=a.result;b.debug(c);if("Senior"==e){f(c)}else{g(c)}},fail:function fail(c){b.debug(c);document.querySelector(".card-img-academic").firstElementChild.style.display="none";a("#card-body-academic-info-text").replaceWith("<p class=\"card-text alert alert-danger\" id =\"card-body-academic-info-text\" >Data not available. Please try later</p>")}}])}function f(b){var d=null==b||0===Object.keys(b).length;if(d){document.querySelector(".card-img-academic").firstElementChild.style.display="none";a("#card-body-academic-info-text").replaceWith("<p class=\"card-text alert alert-danger\" id =\"card-body-academic-info-text\" >Data not available.</p>")}else{var r=document.getElementById("chart-academic");if(!r){return}for(var e=JSON.parse(b),f=[],g=[],h=[],j=[],k=[],l=[],m={avgattendance:"Average Attendance",avgeffort:"Average Effort",avggrades:"Average Grade"},n=0;n<e.length;n++){var o=e[n],p=o.details.year.toString(),q=o.details.term.toString();f.push(["T"+q,p]);l.push(o.details.avggrades);k.push(o.details.avggrades);j.push(o.details.avgeffort);h.push(o.details.avgattendance)}g.push({label:m.avggrades,data:k,fill:!1,borderColor:"#31326f",backgroundColor:"#31326f",tension:.1,spanGaps:!0});g.push({label:m.avgeffort,data:j,fill:!1,borderColor:"#ffc93c",backgroundColor:"#ffc93c",tension:.1,spanGaps:!0});g.push({label:m.avgattendance,data:h,fill:!1,borderColor:"#1687a7",backgroundColor:"#1687a7",tension:.1,spanGaps:!0});document.querySelector(".card-img-academic").firstElementChild.style.display="none";new c(r,{type:"line",data:{labels:f,datasets:g},options:{responsive:!0,maintainAspectRatio:!1}})}}function g(a){var b=document.getElementById("chart-academic");if(!b){return}for(var d=JSON.parse(a),e=[],f=[],g=[],h=[],j=[],k={avgattendance:"Average Attendance",avgeffort:"Average Effort",avggrades:"Average Grade"},l={e:"Excellent (E)",vg:"Very Good (VG)",avg:"Average (AVG)",ni:"Needs Improvement (NI)"},m={be:"Below Expectations",gs:"Good start (GS)",ms:"Making strides (MS)",grwi:"Go run with it (GRWI)",ae:"Above expectations"},n=0;n<d.length;n++){var o=d[n],p=o.details.year.toString(),q=o.details.term.toString();e.push(["T"+q,p]);if(null==o.details.avggrades){o.details.avggrades=void 0}j.push(o.details.avggrades);if(null==o.details.effortaverage){o.details.effortaverage=void 0}h.push(o.details.effortaverage);if(null==o.details.percentageattended){o.details.percentageattended=void 0}g.push(o.details.percentageattended)}f.push({label:k.avggrades,data:j,fill:!1,borderColor:"#31326f",backgroundColor:"#31326f",tension:.1,spanGaps:!0});f.push({label:k.avgeffort,data:h,fill:!1,borderColor:"#ffc93c",backgroundColor:"#ffc93c",tension:.1,spanGaps:!0});f.push({label:k.avgattendance,data:g,fill:!1,borderColor:"#1687a7",backgroundColor:"#1687a7",tension:.1,spanGaps:!0});document.querySelector(".card-img-academic").firstElementChild.style.display="none";new c(b,{type:"line",data:{labels:e,datasets:f},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function label(a){if(a.dataset.label==k.avggrades){if(0<a.parsed.y&&20>=a.parsed.y){return m.be}else if(20<a.parsed.y&&40>=a.parsed.y){return m.gs}else if(40<a.parsed.y&&60>=a.parsed.y){return m.ms}else if(60<a.parsed.y&&80>=a.parsed.y){return m.grwi}else if(80<a.parsed.y){return m.ae}}if(a.dataset.label==k.avgeffort){if(0<parseFloat(a.parsed.y)&&25>=parseFloat(a.parsed.y)){return l.ni}else if(25<parseFloat(a.parsed.y)&&50>=parseFloat(a.parsed.y)){return l.avg}else if(50<parseFloat(a.parsed.y)&&95>parseFloat(a.parsed.y)){return l.vg}else if(95<=parseFloat(a.parsed.y)){return l.e}}else{return a.parsed.y+"%"}}}}},scales:{y:{suggestedMin:25,display:!0}}}})}function h(){var a,b,c,d,e,f,g;a=document.getElementById("searchReportInput");b=a.value.toUpperCase();c=document.getElementById("reports-table");d=c.getElementsByTagName("tr");for(f=0;f<d.length;f++){e=d[f].getElementsByTagName("td")[2];if(e){g=e.textContent||e.innerText;var h=g.split("/").pop();if(-1<h.toUpperCase().indexOf(b)){d[f].style.display=""}else{d[f].style.display="none"}}}}function i(a){var b,c,d,e,f,g,h,j=a.target.id;b=document.getElementById(j);c=b.value.toUpperCase();d="searchByClassGradeInput"==j?document.getElementById("grade-history-table"):document.getElementById("effort-history-table");e=d.getElementsByTagName("tr");for(g=1;g<e.length;g++){var k=e[g].classList;if(k.contains("reports-heading")||k.contains("my-student-learning-title"))continue;f=e[g].getElementsByTagName("td")[0];if(f){h=f.textContent||f.innerText;if(-1<h.toUpperCase().indexOf(c)){e[g].style.display=""}else{e[g].style.display="none"}}}}function j(a){var c=a.target.getAttribute("data-tdss");d.call([{methodname:"report_mystudent_get_student_academic_report",args:{tdocumentsseq:c},done:function done(a){var b=JSON.parse(a.blob);k(b)},fail:function fail(a){b.error("block_academic_report_get_student_report: Unable to get blob.");b.debug(a)}}])}function k(){return l.apply(this,arguments)}function l(){l=_asyncToGenerator(regeneratorRuntime.mark(function a(b){var c,d,e;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:a.next=2;return fetch("data:application/pdf;base64,".concat(b));case 2:c=a.sent;a.next=5;return c.blob();case 5:d=a.sent;e=URL.createObjectURL(d);window.open(e);case 8:case"end":return a.stop();}}},a)}));return l.apply(this,arguments)}function m(){var c=document.querySelector(".cgs-dashboard-academic-info-container"),e=c.getAttribute("data-username"),f=c.getAttribute("data-campus");a("#grade-history-tb").removeAttr("hidden");d.call([{methodname:"report_mystudent_get_grade_history",args:{username:e,campus:f},done:function done(c){b.debug(c);var d=c.html;a("#grade-history-tb").attr("hidden",!0);a("[data-region=\"grade-history-table\"]").replaceWith(d);a(".pop-up-effort").removeAttr("disabled")},fail:function fail(c){b.error("report_mystudent: Unable to get context.");b.debug(c);a("#grade-history-tb").attr("hidden",!0);a("[data-region=\"grade-history-table\"]").replaceWith("<p class=\"alert alert-danger\">Data not available. Please try later</p>")}}])}function n(){var c=document.querySelector(".cgs-dashboard-academic-info-container"),e=c.getAttribute("data-username"),f=c.getAttribute("data-campus");a("#effort-history-tb").removeAttr("hidden");d.call([{methodname:"report_mystudent_get_effort_history",args:{username:e,campus:f},done:function done(c){b.debug(c);var d=c.html;a("#effort-history-tb").attr("hidden",!0);a("[data-region=\"effort-history-table\"]").replaceWith(d);a(".pop-up-grade").removeAttr("disabled")},fail:function fail(c){b.error("report_mystudent: Unable to get context.");b.debug(c);a("#effort-history-tb").attr("hidden",!0);a("[data-region=\"effort-history-table\"]").replaceWith("<p class=\"alert alert-danger\">Data not available. Please try later</p>")}}])}function o(){var c=document.querySelector(".cgs-dashboard-academic-info-container"),e=c.getAttribute("data-username");a("#assignment-tb").removeAttr("hidden");d.call([{methodname:"report_mystudent_get_assign_context",args:{username:e},done:function done(b){var c=b.html;a("#assignment-tb").attr("hidden",!0);a("[data-region=\"assignment-table\"]").replaceWith(c)},fail:function fail(c){b.error("report_mystudent: Unable to get context.");b.debug(c);a("#assignment-tb").attr("hidden",!0);a("[data-region=\"assignment-table\"]").replaceWith("<p class=\"alert alert-danger\">Data not available. Please try later</p>")}}])}function p(a){var b,c;a.target.classList.remove("fa-external-link");a.target.classList.add("fa-window-close");a.target.setAttribute("title","Close");Y.log(a);if(a.target.classList.contains("pop-up-grade")){b=document.querySelector(".pop-up-grade").closest("div.cgs-grade-history-container");c=b.closest("div.cgs-grade-main-container");document.getElementById("grade-history-table").closest("div.grades-his").classList.add("modal-history-content");c.classList.add("modal-history-background");document.querySelector(".pop-up-grade.fa-window-close").addEventListener("click",q);document.querySelector(".pop-up-grade").removeEventListener("click",p)}else{b=document.querySelector(".pop-up-effort").closest("div.cgs-effort-history-container");c=b.closest("div.cgs-effort-main-container");document.getElementById("effort-history-table").closest("div.effort-his").classList.add("modal-history-content");c.classList.add("modal-history-background");document.querySelector(".pop-up-effort.fa-window-close").addEventListener("click",q);document.querySelector(".pop-up-effort").removeEventListener("click",p)}}function q(a){var b=a.target.classList.contains("pop-up-grade"),c=a.target.classList.contains("pop-up-grade")?a.target.closest("div.grades-his"):a.target.closest("div.effort-his");c.classList.remove("modal-history-content");if(b){c.closest(".cgs-grade-main-container").classList.remove("modal-history-background")}else{c.closest(".cgs-effort-main-container").classList.remove("modal-history-background")}a.target.classList.add("fa-external-link");a.target.classList.remove("fa-window-close");a.target.setAttribute("title","Expand");document.querySelector(".pop-up-grade").removeEventListener("click",q);document.querySelector(".pop-up-effort").removeEventListener("click",q);document.querySelector(".pop-up-grade").addEventListener("click",p);document.querySelector(".pop-up-effort").addEventListener("click",p)}return{init:function(a){if("dashboard"==a){e()}else{document.getElementById("searchReportInput").addEventListener("keyup",h);document.getElementById("searchByClassGradeInput").addEventListener("keyup",i);document.getElementById("searchByClassEffortInput").addEventListener("keyup",i);document.querySelector(".pop-up-grade").addEventListener("click",p);document.querySelector(".pop-up-effort").addEventListener("click",p);document.querySelectorAll(".file-pdf").forEach(function(a){a.addEventListener("click",j)});n();o();m()}}}});
//# sourceMappingURL=academicinfo.min.js.map
