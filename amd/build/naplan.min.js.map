{"version":3,"sources":["../src/naplan.js"],"names":["define","$","Log","Chart","renderBarChar","ctx","document","getElementById","results","JSON","parse","getAttribute","datasets","i","data","length","label","backgroundColor","backgroundcolor","borderColor","borderWidth","push","debug","register","id","beforeDraw","chart","canvas","getContext","save","globalCompositeOperation","fillStyle","fillRect","width","height","restore","config","type","labels","options","scales","y","suggestedMax","min","title","text","display","interaction","mode","intersect","responsive","plugins","tooltip","callbacks","context","minStd","aboveStd","dataset","parsed","custom_naplan_canvas_background_color","legend","position","myChart","init","naplanscale","hover","append","find","last","remove"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n// /**\n//  * @package   report_mystudent\n//  * @copyright 2022 Veronica Bermegui\n//  * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n//  */\n\ndefine(['jquery', 'core/log', 'report_mystudent/chart'], function ($, Log, Chart) {\n    'use strict';\n\n    function init(naplanscale) {\n\n        $(\"#scale-info\").hover(function () {\n            $(this).append($('<img id = \"scaleimg\" src=\" ' + naplanscale + '\"' + '>'));\n        }, function () {\n            $(this).find(\"img\").last().remove();\n        });\n        renderBarChar();\n    }\n\n\n    function renderBarChar() {\n        const ctx = document.getElementById(\"resultsChart\");\n        if (!ctx) {\n            return;\n        }\n\n        const results = JSON.parse(ctx.getAttribute('data-results'));\n        const datasets = [];\n\n        for (let i = 0; i < results.datasets.length; i++) {\n            let data = {\n                label: results.datasets[i].label,\n                data: results.datasets[i].results,\n                backgroundColor: results.datasets[i].backgroundcolor,\n                borderColor: results.datasets[i].backgroundcolor,\n                borderWidth: 1\n            }\n            datasets.push(data);\n        }\n\n        Log.debug(datasets);\n\n        Chart.register({\n            id: 'custom_naplan_canvas_background_color',\n            beforeDraw: (chart) => {\n                const ctx = chart.canvas.getContext('2d');\n                ctx.save();\n                ctx.globalCompositeOperation = 'destination-over';\n                ctx.fillStyle = '#f6f5f5';\n                ctx.fillRect(0, 0, chart.width, chart.height);\n                ctx.restore();\n            }\n        });\n\n        const config = {\n            type: 'bar',\n            labels: results.labels,\n            data: {\n                labels: results.labels,\n                datasets: datasets,\n            },\n            options: {\n                scales: {\n                    y: {\n                        suggestedMax: 10,\n                        min: 1,\n                        title: {\n                            text: 'Band',\n                            display: true,\n                        }\n                    },\n                },\n                interaction: {\n                    mode: 'point',\n                    intersect: false,\n                },\n                responsive: true,\n                plugins: {\n                    tooltip: {\n                        callbacks: {\n                            label: function (context) {\n                                const belowStd = 'Below the national minimun standard';\n                                const minStd = 'National minimun standard';\n                                const aboveStd = 'Above the national minimun standard';\n                                if (context.dataset.label == 'Year 3') {\n                                    if (context.parsed.y >= 3) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                    } else if (context.parse.y == 2) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                    } else {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                    }\n                                } else if (context.dataset.label == 'Year 5') {\n                                    if (context.parsed.y >= 5) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                    } else if (context.parse.y == 4) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                    } else {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                    }\n                                } else if (context.dataset.label == 'Year 7') {\n                                    if (context.parsed.y >= 6) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                    } else if (context.parse.y == 5) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                    } else {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                    }\n                                } else if (context.dataset.label == 'Year 9') {\n                                    if (context.parsed.y >= 7) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                    } else if (context.parse.y == 6) {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                    } else {\n                                        return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                    }\n                                }\n                            },\n                        }\n                    },\n                    custom_naplan_canvas_background_color: true\n                },\n                legend: {\n                    position: 'top',\n                },\n\n            }\n        };\n\n        const myChart = new Chart(ctx, config);\n\n    }\n\n    return {\n        init: init\n    }\n});"],"file":"naplan.min.js"}