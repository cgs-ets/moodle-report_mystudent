{"version":3,"sources":["../src/naplan.js"],"names":["define","$","Chart","Ajax","getNaplanResult","username","document","querySelector","getAttribute","firstElementChild","style","display","call","methodname","args","done","response","htmlResult","result","renderBarChar","fail","pelement","createElement","textContent","getElementById","appendChild","replaceWith","isEmpty","Object","keys","length","ctx","results","JSON","parse","datasets","i","data","label","backgroundColor","backgroundcolor","borderColor","tension","borderWidth","borderRadius","borderSkipped","push","config","type","labels","options","scales","y","suggestedMax","min","title","text","interaction","mode","intersect","responsive","maintainAspectRatio","plugins","tooltip","callbacks","context","minStd","aboveStd","dataset","parsed","legend","position","open_naplan_scale","on","modal","close_naplan_scale","init","window","onclick","event","target"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n// /**\n//  * @package   report_mystudent\n//  * @copyright 2022 Veronica Bermegui\n//  * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n//  */\n\ndefine(['jquery', 'report_mystudent/chart', 'core/ajax', 'core/modal_factory'], function ($, Chart, Ajax, ModalFactory) {\n    'use strict';\n\n    function init() {\n        getNaplanResult();\n        open_naplan_scale();\n        close_naplan_scale();\n\n        window.onclick = function (event) {\n            var modal = document.getElementById(\"myModal\");\n            if (event.target == document.getElementById(\"myModal\")) {\n                modal.style.display = \"none\";\n            }\n        }\n    }\n\n    function getNaplanResult() {\n\n        const username = document.querySelector('[data-username]').getAttribute('data-username');\n\n        document.querySelector('.card-top-naplan').firstElementChild.style.display = \"flex\"\n\n        Ajax.call([{\n            methodname: 'report_mystudent_get_naplan_result',\n            args: {\n                username: username,\n            },\n\n            done: function (response) {\n                const htmlResult = response.result;\n                renderBarChar(htmlResult);\n\n            },\n\n            fail: function (reason) {\n                // remove spinner\n                document.querySelector('.card-body-naplan').firstElementChild.style.display = \"none\"\n                document.querySelector('.card-top-naplan').firstElementChild.style.display = \"none\"\n\n                const pelement = document.createElement('p');\n                pelement.textContent = \"There was a problem when getting data. Please try again later\";\n                document.getElementById('chart-naplan').appendChild(pelement);\n                $('#card-body-naplan-text').replaceWith('<p class=\"card-text alert alert-danger\" id =\"card-body-naplan-text\" >Data not available. Please try later</p>');\n\n            }\n        }]);\n\n    };\n\n\n    function renderBarChar(result) {\n        const isEmpty = result == null || Object.keys(result).length === 0;\n        if (isEmpty) {\n            document.querySelector('.card-top-naplan').firstElementChild.style.display = \"none\";\n            $('#card-body-naplan-text').replaceWith('<p class=\"card-text alert alert-danger\" id =\"card-body-academic-info-text\" >Data not available.</p>');\n        } else {\n\n            const ctx = document.getElementById(\"chart-naplan\");\n            if (!ctx) {\n                return;\n            }\n\n            const results = JSON.parse(result);\n            const datasets = [];\n\n            for (let i = 0; i < results.datasets.length; i++) {\n                let data = {\n                    label: results.datasets[i].label,\n                    data: results.datasets[i].results,\n                    backgroundColor: results.datasets[i].backgroundcolor,\n                    borderColor: results.datasets[i].backgroundcolor,\n                    tension: 0.4,\n                    borderWidth: 0,\n                    borderRadius: 4,\n                    borderSkipped: false,\n                    borderWidth: 1,\n\n                }\n                datasets.push(data);\n            }\n\n\n            const config = {\n                type: 'bar',\n                labels: results.labels,\n                data: {\n                    labels: results.labels,\n                    datasets: datasets,\n                },\n                options: {\n                    scales: {\n                        y: {\n                            suggestedMax: 10,\n                            min: 1,\n                            title: {\n                                text: 'Band',\n                                display: true,\n                            }\n                        },\n                    },\n                    interaction: {\n                        mode: 'point',\n                        intersect: false,\n                    },\n                    responsive: true,\n                    maintainAspectRatio: false,\n                    plugins: {\n                        tooltip: {\n                            callbacks: {\n                                label: function (context) {\n                                    const belowStd = 'Below the national minimun standard';\n                                    const minStd = 'National minimun standard';\n                                    const aboveStd = 'Above the national minimun standard';\n                                    if (context.dataset.label == 'Year 3') {\n                                        if (context.parsed.y >= 3) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                        } else if (context.parse.y == 2) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                        } else {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                        }\n                                    } else if (context.dataset.label == 'Year 5') {\n                                        if (context.parsed.y >= 5) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                        } else if (context.parse.y == 4) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                        } else {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                        }\n                                    } else if (context.dataset.label == 'Year 7') {\n                                        if (context.parsed.y >= 6) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                        } else if (context.parse.y == 5) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                        } else {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                        }\n                                    } else if (context.dataset.label == 'Year 9') {\n                                        if (context.parsed.y >= 7) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + aboveStd;\n                                        } else if (context.parse.y == 6) {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + minStd;\n                                        } else {\n                                            return context.dataset.label + \": Band \" + context.parsed.y + '. ' + belowStd;\n                                        }\n                                    }\n                                },\n                            }\n                        },\n                    },\n                    legend: {\n                        position: 'top',\n                    },\n\n                }\n            };\n            // remove spinner\n            document.querySelector('.card-top-naplan').firstElementChild.style.display = \"none\";\n            const myChart = new Chart(ctx, config);\n        }\n\n    }\n\n    function open_naplan_scale() {\n        $('a.naplan-scale').on('click', function (e) {\n            var modal = document.getElementById(\"myModal\");\n            modal.style.display = \"block\";\n        });\n    }\n\n    function close_naplan_scale() {\n        $('i.cgs-naplan-close').on('click', function (e) {\n\n            var modal = document.getElementById(\"myModal\");\n            modal.style.display = \"none\";\n        });\n    }\n\n    return {\n        init: init\n    }\n});"],"file":"naplan.min.js"}